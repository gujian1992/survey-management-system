# SecurityConfig æƒé™é…ç½®è¯´æ˜

## ğŸ¯ æƒé™ä½“ç³»é‡æ„å®Œæˆ

### ğŸ“‹ é‡æ„ç›®æ ‡
- åˆ é™¤æ‰€æœ‰åºŸå¼ƒçš„é—®å·ç³»ç»ŸAPIæƒé™é…ç½®
- åªä¿ç•™å½“å‰ç³»ç»Ÿå®é™…ä½¿ç”¨çš„æ–°æ¶æ„API
- ç»“åˆå‰ç«¯è·¯ç”±ä¼˜åŒ–æƒé™æ§åˆ¶
- å®ç°æ¸…æ™°çš„æƒé™åˆ†å±‚ç®¡ç†

---

## ğŸ—ï¸ æ–°æƒé™ä½“ç³»æ¶æ„

### **1. ğŸ”“ å…¬å¼€è®¿é—®æ¥å£**
```java
// APIæ–‡æ¡£å’Œå¼€å‘å·¥å…·
"/swagger-ui/**", "/swagger-ui.html", "/webjars/**", "/v3/api-docs/**", "/swagger-resources/**"

// è®¤è¯ç›¸å…³æ¥å£ (ç™»å½•/ç™»å‡º/æ³¨å†Œ/ä¼šè¯ç®¡ç†)
"/api/auth/**"

// æµ‹è¯•æ¥å£ (å¼€å‘è°ƒè¯•ç”¨)
"/api/test/**"
```

### **2. ğŸ‘‘ ç®¡ç†å‘˜ä¸“å±æ¥å£ (ADMIN)**
```java
// é¢˜åº“ç®¡ç†
"/api/question-bank/**"             // é¢˜åº“å¢åˆ æ”¹æŸ¥ã€åˆ†é¡µæŸ¥è¯¢

// è¯„åˆ†ç®¡ç†  
"/api/scoring/**"                   // è¯„åˆ†è®°å½•ã€æ‰¹é‡è¯„åˆ†ã€è¯„åˆ†ç»Ÿè®¡

// ç»Ÿè®¡åˆ†æ
"/api/statistics/**"                // æ•°æ®ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æã€æŠ¥è¡¨ç”Ÿæˆ

// ç­”é¢˜ä¼šè¯ç®¡ç† (ç®¡ç†å‘˜åŠŸèƒ½)
"/api/answer-session/admin/**"      // æ‰€æœ‰ä¼šè¯ç®¡ç†
"/api/answer-session/user/*/stats"  // ç”¨æˆ·ç»Ÿè®¡

// ç­”é¢˜è®°å½•ç®¡ç† (ç®¡ç†å‘˜åŠŸèƒ½)
"/api/answer-record/need-scoring"          // éœ€è¦è¯„åˆ†çš„è®°å½•
"/api/answer-record/batch-auto-score/*"    // æ‰¹é‡è‡ªåŠ¨è¯„åˆ†
```

### **3. ğŸ‘¤ è®¤è¯ç”¨æˆ·æ¥å£ (USER + ADMIN)**
```java
// ç­”é¢˜ä¼šè¯ (ç”¨æˆ·æ ¸å¿ƒåŠŸèƒ½)
"/api/answer-session/start"                    // å¼€å§‹ç­”é¢˜ä¼šè¯
"/api/answer-session/my-sessions"              // æˆ‘çš„ç­”é¢˜ä¼šè¯åˆ—è¡¨  
"/api/answer-session/my-stats"                 // æˆ‘çš„ç­”é¢˜ç»Ÿè®¡
"GET /api/answer-session/*"                    // è·å–ä¼šè¯ä¿¡æ¯
"/api/answer-session/*/finish"                 // å®Œæˆç­”é¢˜ä¼šè¯
"/api/answer-session/*/abandon"                // æ”¾å¼ƒç­”é¢˜ä¼šè¯
"/api/answer-session/*/check-timeout"          // æ£€æŸ¥ä¼šè¯è¶…æ—¶

// ç­”é¢˜è®°å½• (ç”¨æˆ·æ ¸å¿ƒåŠŸèƒ½)  
"/api/answer-record/submit"                    // æäº¤ç­”æ¡ˆ
"/api/answer-record/next-question/*"           // è·å–ä¸‹ä¸€é¢˜
"GET /api/answer-record/*"                     // è·å–è®°å½•è¯¦æƒ…
"/api/answer-record/session/*"                 // è·å–ä¼šè¯çš„æ‰€æœ‰è®°å½•
```

---

## ğŸ”„ å‰åç«¯æƒé™æ˜ å°„

### **ç®¡ç†å‘˜è·¯ç”± â†’ åç«¯APIæ˜ å°„**
```javascript
// å‰ç«¯è·¯ç”±                    â†’ åç«¯APIæƒé™
'/dashboard'                  â†’ è®¤è¯ç”¨æˆ· + ç»Ÿè®¡API(ADMIN)
'/question-bank'              â†’ /api/question-bank/** (ADMIN)
'/answer-sessions'            â†’ /api/answer-session/admin/** (ADMIN)  
'/scoring'                    â†’ /api/scoring/** (ADMIN)
'/statistics'                 â†’ /api/statistics/** (ADMIN)
```

### **ç”¨æˆ·è·¯ç”± â†’ åç«¯APIæ˜ å°„**
```javascript
// å‰ç«¯è·¯ç”±                    â†’ åç«¯APIæƒé™
'/start-answer'               â†’ /api/answer-session/start (USER+ADMIN)
'/answer/:sessionCode'        â†’ /api/answer-record/** (USER+ADMIN)
```

---

## ğŸš€ é‡æ„ä¼˜åŠ¿

### **1. é…ç½®ç®€æ´æ¸…æ™°**
- ä»åŸæ¥çš„**25+æ¡å¤æ‚è§„åˆ™**ç®€åŒ–ä¸º**12æ¡æ ¸å¿ƒè§„åˆ™**
- æŒ‰åŠŸèƒ½æ¨¡å—æ¸…æ™°åˆ†ç»„ï¼Œæ˜“äºç»´æŠ¤
- åˆ é™¤äº†æ‰€æœ‰åºŸå¼ƒçš„é—®å·ç³»ç»Ÿé…ç½®

### **2. æƒé™ç²’åº¦åˆç†**
- **æ¨¡å—çº§æƒé™æ§åˆ¶**: æ•´ä¸ªæ¨¡å—ç»Ÿä¸€æƒé™ç®¡ç†
- **åŠŸèƒ½çº§æƒé™åˆ†ç¦»**: ç®¡ç†åŠŸèƒ½vsç”¨æˆ·åŠŸèƒ½æ˜ç¡®åŒºåˆ†
- **æ¥å£çº§ç²¾ç¡®æ§åˆ¶**: å…³é”®æ¥å£å•ç‹¬é…ç½®æƒé™

### **3. æ‰©å±•æ€§è‰¯å¥½**
- æ–°å¢åŠŸèƒ½æ¨¡å—æ—¶ï¼Œåªéœ€åœ¨å¯¹åº”åˆ†ç»„æ·»åŠ é…ç½®
- æƒé™ç»§æ‰¿å…³ç³»æ¸…æ™°ï¼Œä¾¿äºç†è§£å’Œä¿®æ”¹
- æ”¯æŒæ–¹æ³•çº§æ³¨è§£æƒé™ä½œä¸ºè¡¥å……

### **4. å®‰å…¨æ€§æå‡**
- é‡‡ç”¨ç™½åå•æ¨¡å¼ï¼Œé»˜è®¤éœ€è¦è®¤è¯
- æ•æ„Ÿæ“ä½œä¸¥æ ¼é™åˆ¶ä¸ºç®¡ç†å‘˜æƒé™
- ç”¨æˆ·åŠŸèƒ½å’Œç®¡ç†åŠŸèƒ½å®Œå…¨éš”ç¦»

---

## ğŸ“ é…ç½®å˜æ›´æ€»ç»“

### **åˆ é™¤çš„åºŸå¼ƒé…ç½®**
```java
// æ—§é—®å·ç³»ç»Ÿç›¸å…³ (å·²åˆ é™¤)
"/api/questionnaire/**"
"/api/answer/**" 
"/api/records/**"
"/api/users/**"
```

### **æ–°å¢çš„ç°ä»£é…ç½®**
```java
// æ–°ç­”é¢˜ç³»ç»Ÿç›¸å…³ (å·²æ·»åŠ )
"/api/question-bank/**"
"/api/answer-session/**"
"/api/answer-record/**"
"/api/scoring/**"
"/api/statistics/**"
```

### **ä¿ç•™çš„æ ¸å¿ƒé…ç½®**
```java
// åŸºç¡€è®¾æ–½ç›¸å…³ (ä¿ç•™)
"/api/auth/**"     // è®¤è¯ä½“ç³»
"/api/test/**"     // æµ‹è¯•æ¥å£
"Swaggerç›¸å…³"       // APIæ–‡æ¡£
```

---

## ğŸ”§ ä½¿ç”¨å»ºè®®

### **å¼€å‘é˜¶æ®µ**
1. æ–°å¢Controlleræ—¶ï¼Œä¼˜å…ˆä½¿ç”¨æ–¹æ³•çº§`@PreAuthorize`æ³¨è§£
2. åªæœ‰é€šç”¨æ¨¡å—æ‰åœ¨SecurityConfigä¸­é…ç½®
3. æµ‹è¯•æ¥å£åº”è¯¥ä¿æŒ`/api/test/**`å‰ç¼€

### **ç”Ÿäº§éƒ¨ç½²**
1. ç¦ç”¨æˆ–é™åˆ¶è®¿é—®`/api/test/**`æ¥å£
2. å®šæœŸå®¡æŸ¥æƒé™é…ç½®ï¼Œç¡®ä¿æœ€å°æƒé™åŸåˆ™
3. ç›‘æ§æƒé™è®¿é—®æ—¥å¿—ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸

---

**âœ… é‡æ„å®Œæˆï¼ç°åœ¨æ‹¥æœ‰äº†ç®€æ´ã€ç°ä»£ã€æ˜“ç»´æŠ¤çš„æƒé™é…ç½®ä½“ç³»ï¼** 